import{r as e,c as r,b as t}from"./vendor-34749a99.js";import{u as o,Q as n,a as s}from"./query-a34aeb08.js";import{u as a,L as i,R as l,a as c,B as d}from"./router-95e30238.js";import{a as m,c as p}from"./utils-b3c35dc8.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&r(e)}).observe(document,{childList:!0,subtree:!0})}function r(e){if(e.ep)return;e.ep=!0;const r=function(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?r.credentials="include":"anonymous"===e.crossOrigin?r.credentials="omit":r.credentials="same-origin",r}(e);fetch(e.href,r)}}();var u={exports:{}},h={},g=e,x=Symbol.for("react.element"),f=Symbol.for("react.fragment"),y=Object.prototype.hasOwnProperty,v=g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,b={key:!0,ref:!0,__self:!0,__source:!0};function j(e,r,t){var o,n={},s=null,a=null;for(o in void 0!==t&&(s=""+t),void 0!==r.key&&(s=""+r.key),void 0!==r.ref&&(a=r.ref),r)y.call(r,o)&&!b.hasOwnProperty(o)&&(n[o]=r[o]);if(e&&e.defaultProps)for(o in r=e.defaultProps)void 0===n[o]&&(n[o]=r[o]);return{$$typeof:x,type:e,key:s,ref:a,props:n,_owner:v.current}}h.Fragment=f,h.jsx=j,h.jsxs=j,u.exports=h;var w,S=u.exports,_=r;w=_.createRoot,_.hydrateRoot;const E={},N=function(e,r,t){if(!r||0===r.length)return e();const o=document.getElementsByTagName("link");return Promise.all(r.map(e=>{if((e=function(e){return"/"+e}(e))in E)return;E[e]=!0;const r=e.endsWith(".css"),n=r?'[rel="stylesheet"]':"";if(!!t)for(let t=o.length-1;t>=0;t--){const n=o[t];if(n.href===e&&(!r||"stylesheet"===n.rel))return}else if(document.querySelector(`link[href="${e}"]${n}`))return;const s=document.createElement("link");return s.rel=r?"stylesheet":"modulepreload",r||(s.as="script",s.crossOrigin=""),s.href=e,document.head.appendChild(s),r?new Promise((r,t)=>{s.addEventListener("load",r),s.addEventListener("error",()=>t(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=e,window.dispatchEvent(r),!r.defaultPrevented)throw e})};class P extends e.Component{state={hasError:!1};static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){}handleRetry=()=>{this.setState({hasError:!1,error:void 0})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:S.jsxs("div",{className:"error-boundary",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"400px",padding:"2rem",textAlign:"center"},children:[S.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"😵"}),S.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"600",marginBottom:"1rem",color:"var(--color-text)"},children:"Oops! Something went wrong"}),S.jsx("p",{style:{color:"var(--color-text-light)",marginBottom:"2rem",maxWidth:"500px"},children:"We encountered an unexpected error. Please try refreshing the page or contact support if the problem persists."}),!1,S.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[S.jsx("button",{onClick:this.handleRetry,className:"btn",style:{backgroundColor:"var(--color-primary)",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"var(--border-radius)",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:"Try Again"}),S.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-outline",style:{backgroundColor:"transparent",color:"var(--color-primary)",border:"2px solid var(--color-primary)",padding:"0.75rem 1.5rem",borderRadius:"var(--border-radius)",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:"Refresh Page"})]})]}):this.props.children}}const R=e.memo(({size:e="medium",message:r="Loading...",className:t=""})=>{const{spinner:o,text:n}={small:{spinner:"20px",text:"0.875rem"},medium:{spinner:"40px",text:"1rem"},large:{spinner:"60px",text:"1.125rem"}}[e];return S.jsxs("div",{className:`loading-spinner ${t}`,style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"2rem"},role:"status","aria-label":r,children:[S.jsx("div",{className:"spinner",style:{border:"3px solid #f3f3f3",borderTop:"3px solid var(--color-primary)",borderRadius:"50%",width:o,height:o,animation:"spin 1s linear infinite",marginBottom:"1rem"}}),r&&S.jsx("p",{style:{fontSize:n,color:"var(--color-text-light)",margin:0},children:r})]})});function k(r,t){const[o,n]=e.useState(r);return e.useEffect(()=>{const e=setTimeout(()=>{n(r)},t);return()=>{clearTimeout(e)}},[r,t]),o}R.displayName="LoadingSpinner";const C=m.create({baseURL:{}.VITE_API_BASE_URL||"https://api.example.com",timeout:1e4,headers:{"Content-Type":"application/json"}});C.interceptors.request.use(e=>(e.metadata={startTime:Date.now()},e),e=>Promise.reject(e)),C.interceptors.response.use(e=>{Date.now(),e.config.metadata;return e},e=>(e.response,Promise.reject(e)));const L=new Map;async function D(e,r,t=5e3){if(L.has(e))return L.get(e);const o=r().then(e=>e.data).finally(()=>{setTimeout(()=>{L.delete(e)},t)});return L.set(e,o),o}const I={getProducts:async(e={},r=1,t=20)=>{const o=new URLSearchParams({page:r.toString(),limit:t.toString(),...Object.entries(e).reduce((e,[r,t])=>(null!=t&&(e[r]=t.toString()),e),{})});return D(`products-${o.toString()}`,()=>C.get(`/products?${o}`))},getProduct:async e=>D(`product-${e}`,()=>C.get(`/products/${e}`),1e4),searchProducts:async(e,r=10)=>{if(!e.trim())return[];return D(`search-${e}-${r}`,()=>C.get(`/products/search?q=${encodeURIComponent(e)}&limit=${r}`),2e3)}},O={getCategories:async()=>D("categories",()=>C.get("/categories"),3e4),getCategory:async e=>D(`category-${e}`,()=>C.get(`/categories/${e}`))},T={products:(e={})=>{I.getProducts(e,1,20)},categories:()=>{O.getCategories()}},z=e.memo(({onSearchSelect:r,placeholder:t="Search products...",className:n})=>{const[s,a]=e.useState(""),[i,l]=e.useState(!1),[c,d]=e.useState(-1),m=e.useRef(null),u=e.useRef(null),h=k(s,300),{data:g=[],isLoading:x}=o(["search",h],()=>I.searchProducts(h,8),{enabled:h.length>=2,staleTime:3e4,cacheTime:3e5}),f=e=>{a(e.name),l(!1),d(-1),r?.(e)};return e.useEffect(()=>{const e=e=>{!u.current||u.current.contains(e.target)||m.current?.contains(e.target)||l(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),S.jsxs("div",{className:p("search-bar",n),style:{position:"relative"},children:[S.jsxs("div",{className:"search-input-container",style:{position:"relative"},children:[S.jsx("input",{ref:m,type:"text",value:s,onChange:e=>{const r=e.target.value;a(r),d(-1),l(r.length>=2)},onKeyDown:e=>{if(i&&0!==g.length)switch(e.key){case"ArrowDown":e.preventDefault(),d(e=>e<g.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),d(e=>e>0?e-1:g.length-1);break;case"Enter":e.preventDefault(),c>=0&&f(g[c]);break;case"Escape":l(!1),d(-1),m.current?.blur()}},onFocus:()=>s.length>=2&&l(!0),placeholder:t,className:"search-input",style:{width:"100%",padding:"0.75rem 3rem 0.75rem 1rem",border:"2px solid var(--color-border)",borderRadius:"var(--border-radius)",fontSize:"1rem",transition:"var(--transition)"},"aria-label":"Search products","aria-autocomplete":"list","aria-expanded":i,role:"combobox"}),S.jsx("div",{className:"search-icon",style:{position:"absolute",right:"1rem",top:"50%",transform:"translateY(-50%)",color:"var(--color-text-light)",pointerEvents:"none"},children:"🔍"}),x&&S.jsx("div",{className:"search-loading",style:{position:"absolute",right:"3rem",top:"50%",transform:"translateY(-50%)"},children:S.jsx("div",{className:"spinner",style:{width:"16px",height:"16px"}})})]}),i&&S.jsx("div",{ref:u,className:"search-results",style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"var(--color-bg)",border:"1px solid var(--color-border)",borderRadius:"var(--border-radius)",boxShadow:"var(--box-shadow)",maxHeight:"400px",overflowY:"auto",zIndex:1e3},role:"listbox",children:g.length>0?g.map((e,r)=>S.jsx("div",{onClick:()=>f(e),className:p("search-result-item",{selected:r===c}),style:{padding:"0.75rem 1rem",cursor:"pointer",borderBottom:r<g.length-1?"1px solid var(--color-border)":"none",backgroundColor:r===c?"var(--color-bg-light)":"transparent",transition:"var(--transition)"},role:"option","aria-selected":r===c,children:S.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[S.jsx("img",{src:e.thumbnailUrl||e.imageUrl,alt:e.name,style:{width:"40px",height:"40px",objectFit:"cover",borderRadius:"var(--border-radius)",marginRight:"0.75rem"},loading:"lazy"}),S.jsxs("div",{children:[S.jsx("div",{style:{fontWeight:"500",marginBottom:"0.25rem"},children:e.name}),S.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--color-text-light)",fontWeight:"600"},children:["$",e.price.toFixed(2)]})]})]})},e.id)):h.length>=2&&!x?S.jsxs("div",{className:"no-results",style:{padding:"1rem",textAlign:"center",color:"var(--color-text-light)"},children:['No products found for "',h,'"']}):null})]})});z.displayName="SearchBar";const $=e.memo(()=>{const e=a();return S.jsx("header",{className:"header",style:{backgroundColor:"var(--color-bg)",borderBottom:"1px solid var(--color-border)",position:"sticky",top:0,zIndex:100,boxShadow:"var(--box-shadow)"},children:S.jsx("div",{className:"container",children:S.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1rem 0"},children:[S.jsx(i,{to:"/",className:"logo",style:{fontSize:"1.5rem",fontWeight:"700",color:"var(--color-primary)",textDecoration:"none",display:"flex",alignItems:"center"},children:"🛍️ ProductPortal"}),S.jsx("div",{style:{flex:1,maxWidth:"500px",margin:"0 2rem"},children:S.jsx(z,{onSearchSelect:r=>{e(`/products/${r.id}`)},placeholder:"Search products..."})}),S.jsxs("nav",{className:"nav",style:{display:"flex",alignItems:"center",gap:"1.5rem"},children:[S.jsx(i,{to:"/",className:"nav-link",style:{textDecoration:"none",color:"var(--color-text)",fontWeight:"500",transition:"var(--transition)"},children:"Home"}),S.jsx(i,{to:"/products",className:"nav-link",style:{textDecoration:"none",color:"var(--color-text)",fontWeight:"500",transition:"var(--transition)"},children:"Products"}),S.jsx("button",{className:"btn btn-outline",style:{backgroundColor:"transparent",color:"var(--color-primary)",border:"2px solid var(--color-primary)",padding:"0.5rem 1rem",borderRadius:"var(--border-radius)",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500",textDecoration:"none",display:"inline-flex",alignItems:"center",transition:"var(--transition)"},children:"🛒 Cart"})]})]})})})});$.displayName="Header";const W=e.lazy(()=>N(()=>import("./HomePage-e5b89ce7.js"),["assets/HomePage-e5b89ce7.js","assets/vendor-34749a99.js","assets/query-a34aeb08.js","assets/router-95e30238.js","assets/ProductCard-57f96bb6.js","assets/utils-b3c35dc8.js"])),A=e.lazy(()=>N(()=>import("./ProductsPage-0ab74dba.js"),["assets/ProductsPage-0ab74dba.js","assets/vendor-34749a99.js","assets/query-a34aeb08.js","assets/ProductCard-57f96bb6.js","assets/router-95e30238.js","assets/utils-b3c35dc8.js"])),B=e.lazy(()=>N(()=>import("./ProductDetailPage-859b7e31.js"),["assets/ProductDetailPage-859b7e31.js","assets/vendor-34749a99.js","assets/router-95e30238.js","assets/query-a34aeb08.js","assets/ProductCard-57f96bb6.js","assets/utils-b3c35dc8.js"])),U=e.lazy(()=>N(()=>import("./CategoryPage-65bd6cc7.js"),["assets/CategoryPage-65bd6cc7.js","assets/vendor-34749a99.js","assets/router-95e30238.js","assets/query-a34aeb08.js","assets/ProductCard-57f96bb6.js","assets/utils-b3c35dc8.js"])),F=e.lazy(()=>N(()=>import("./NotFoundPage-0fd9737d.js"),["assets/NotFoundPage-0fd9737d.js","assets/vendor-34749a99.js","assets/router-95e30238.js","assets/query-a34aeb08.js","assets/utils-b3c35dc8.js"]));function q(){return S.jsxs("div",{className:"app",children:[S.jsx($,{}),S.jsx("main",{className:"main-content",children:S.jsx(P,{children:S.jsx(e.Suspense,{fallback:S.jsx(R,{}),children:S.jsxs(l,{children:[S.jsx(c,{path:"/",element:S.jsx(W,{})}),S.jsx(c,{path:"/products",element:S.jsx(A,{})}),S.jsx(c,{path:"/products/:id",element:S.jsx(B,{})}),S.jsx(c,{path:"/category/:slug",element:S.jsx(U,{})}),S.jsx(c,{path:"*",element:S.jsx(F,{})})]})})})})]})}const V=new n({defaultOptions:{queries:{staleTime:3e5,cacheTime:6e5,refetchOnWindowFocus:!1,retry:(e,r)=>!(r instanceof Error&&r.message.includes("4"))&&e<3}}}),H=document.getElementById("root");if(!H)throw new Error("Root element not found");w(H).render(S.jsx(t.StrictMode,{children:S.jsx(s,{client:V,children:S.jsx(d,{children:S.jsx(q,{})})})})),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{}).catch(e=>{})});export{R as L,I as a,O as c,S as j,T as p,k as u};
