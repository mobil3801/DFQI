import{j as e,u as t,L as r,a as o}from"./index-1254aa7c.js";import{r as n}from"./vendor-34749a99.js";import{_ as i,b as s,c as a}from"./query-a34aeb08.js";import{P as l}from"./ProductCard-57f96bb6.js";import"./router-95e30238.js";import"./utils-b3c35dc8.js";function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var c=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function u(e,t){return e===t||!(!c(e)||!c(t))}function h(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!u(e[r],t[r]))return!1;return!0}function m(e,t){var r;void 0===t&&(t=h);var o,n=[],i=!1;return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];return i&&r===this&&t(s,n)||(o=e.apply(this,s),i=!0,r=this,n=s),o}}var f="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function p(e){cancelAnimationFrame(e.id)}var g=-1;function v(e){if(void 0===e&&(e=!1),-1===g||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),g=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return g}var x=null;function y(e){if(void 0===e&&(e=!1),null===x||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var o=document.createElement("div"),n=o.style;return n.width="100px",n.height="100px",t.appendChild(o),document.body.appendChild(t),t.scrollLeft>0?x="positive-descending":(t.scrollLeft=1,x=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),x}return x}var S=function(e,t){return e};function b(e){var t,r=e.getItemOffset,o=e.getEstimatedTotalSize,a=e.getItemSize,l=e.getOffsetForIndexAndAlignment,c=e.getStartIndexForOffset,u=e.getStopIndexForStartIndex,h=e.initInstanceProps,g=e.shouldResetStyleCacheOnItemSizeChange,x=e.validateProps;return t=function(e){function t(t){var o;return(o=e.call(this,t)||this)._instanceProps=h(o.props,d(o)),o._outerRef=void 0,o._resetIsScrollingTimeoutId=null,o.state={instance:d(o),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof o.props.initialScrollOffset?o.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},o._callOnItemsRendered=void 0,o._callOnItemsRendered=m(function(e,t,r,n){return o.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:r,visibleStopIndex:n})}),o._callOnScroll=void 0,o._callOnScroll=m(function(e,t,r){return o.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:r})}),o._getItemStyle=void 0,o._getItemStyle=function(e){var t,n=o.props,i=n.direction,s=n.itemSize,l=n.layout,d=o._getItemStyleCache(g&&s,g&&l,g&&i);if(d.hasOwnProperty(e))t=d[e];else{var c=r(o.props,e,o._instanceProps),u=a(o.props,e,o._instanceProps),h="horizontal"===i||"horizontal"===l,m="rtl"===i,f=h?c:0;d[e]=t={position:"absolute",left:m?void 0:f,right:m?f:void 0,top:h?0:c,height:h?"100%":u,width:h?u:"100%"}}return t},o._getItemStyleCache=void 0,o._getItemStyleCache=m(function(e,t,r){return{}}),o._onScrollHorizontal=function(e){var t=e.currentTarget,r=t.clientWidth,n=t.scrollLeft,i=t.scrollWidth;o.setState(function(e){if(e.scrollOffset===n)return null;var t=o.props.direction,s=n;if("rtl"===t)switch(y()){case"negative":s=-n;break;case"positive-descending":s=i-r-n}return s=Math.max(0,Math.min(s,i-r)),{isScrolling:!0,scrollDirection:e.scrollOffset<s?"forward":"backward",scrollOffset:s,scrollUpdateWasRequested:!1}},o._resetIsScrollingDebounced)},o._onScrollVertical=function(e){var t=e.currentTarget,r=t.clientHeight,n=t.scrollHeight,i=t.scrollTop;o.setState(function(e){if(e.scrollOffset===i)return null;var t=Math.max(0,Math.min(i,n-r));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}},o._resetIsScrollingDebounced)},o._outerRefSetter=function(e){var t=o.props.outerRef;o._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},o._resetIsScrollingDebounced=function(){var e,t,r,n;null!==o._resetIsScrollingTimeoutId&&p(o._resetIsScrollingTimeoutId),o._resetIsScrollingTimeoutId=(e=o._resetIsScrolling,t=150,r=f(),n={id:requestAnimationFrame(function o(){f()-r>=t?e.call(null):n.id=requestAnimationFrame(o)})})},o._resetIsScrolling=function(){o._resetIsScrollingTimeoutId=null,o.setState({isScrolling:!1},function(){o._getItemStyleCache(-1,null)})},o}i(t,e),t.getDerivedStateFromProps=function(e,t){return I(e,t),x(e),null};var b=t.prototype;return b.scrollTo=function(e){e=Math.max(0,e),this.setState(function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},b.scrollToItem=function(e,t){void 0===t&&(t="auto");var r=this.props,o=r.itemCount,n=r.layout,i=this.state.scrollOffset;e=Math.max(0,Math.min(e,o-1));var s=0;if(this._outerRef){var a=this._outerRef;s="vertical"===n?a.scrollWidth>a.clientWidth?v():0:a.scrollHeight>a.clientHeight?v():0}this.scrollTo(l(this.props,e,t,i,this._instanceProps,s))},b.componentDidMount=function(){var e=this.props,t=e.direction,r=e.initialScrollOffset,o=e.layout;if("number"==typeof r&&null!=this._outerRef){var n=this._outerRef;"horizontal"===t||"horizontal"===o?n.scrollLeft=r:n.scrollTop=r}this._callPropsCallbacks()},b.componentDidUpdate=function(){var e=this.props,t=e.direction,r=e.layout,o=this.state,n=o.scrollOffset;if(o.scrollUpdateWasRequested&&null!=this._outerRef){var i=this._outerRef;if("horizontal"===t||"horizontal"===r)if("rtl"===t)switch(y()){case"negative":i.scrollLeft=-n;break;case"positive-ascending":i.scrollLeft=n;break;default:var s=i.clientWidth,a=i.scrollWidth;i.scrollLeft=a-s-n}else i.scrollLeft=n;else i.scrollTop=n}this._callPropsCallbacks()},b.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&p(this._resetIsScrollingTimeoutId)},b.render=function(){var e=this.props,t=e.children,r=e.className,i=e.direction,a=e.height,l=e.innerRef,d=e.innerElementType,c=e.innerTagName,u=e.itemCount,h=e.itemData,m=e.itemKey,f=void 0===m?S:m,p=e.layout,g=e.outerElementType,v=e.outerTagName,x=e.style,y=e.useIsScrolling,b=e.width,I=this.state.isScrolling,_="horizontal"===i||"horizontal"===p,R=_?this._onScrollHorizontal:this._onScrollVertical,w=this._getRangeToRender(),j=w[0],C=w[1],P=[];if(u>0)for(var z=j;z<=C;z++)P.push(n.createElement(t,{data:h,key:f(z,h),index:z,isScrolling:y?I:void 0,style:this._getItemStyle(z)}));var O=o(this.props,this._instanceProps);return n.createElement(g||v||"div",{className:r,onScroll:R,ref:this._outerRefSetter,style:s({position:"relative",height:a,width:b,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:i},x)},n.createElement(d||c||"div",{children:P,ref:l,style:{height:_?"100%":O,pointerEvents:I?"none":void 0,width:_?O:"100%"}}))},b._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],r=e[1],o=e[2],n=e[3];this._callOnItemsRendered(t,r,o,n)}if("function"==typeof this.props.onScroll){var i=this.state,s=i.scrollDirection,a=i.scrollOffset,l=i.scrollUpdateWasRequested;this._callOnScroll(s,a,l)}},b._getRangeToRender=function(){var e=this.props,t=e.itemCount,r=e.overscanCount,o=this.state,n=o.isScrolling,i=o.scrollDirection,s=o.scrollOffset;if(0===t)return[0,0,0,0];var a=c(this.props,s,this._instanceProps),l=u(this.props,a,s,this._instanceProps),d=n&&"backward"!==i?1:Math.max(1,r),h=n&&"forward"!==i?1:Math.max(1,r);return[Math.max(0,a-d),Math.max(0,Math.min(t-1,l+h)),a,l]},t}(n.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var I=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},_=b({getItemOffset:function(e,t){return t*e.itemSize},getItemSize:function(e,t){return e.itemSize},getEstimatedTotalSize:function(e){var t=e.itemCount;return e.itemSize*t},getOffsetForIndexAndAlignment:function(e,t,r,o,n,i){var s=e.direction,a=e.height,l=e.itemCount,d=e.itemSize,c=e.layout,u=e.width,h="horizontal"===s||"horizontal"===c?u:a,m=Math.max(0,l*d-h),f=Math.min(m,t*d),p=Math.max(0,t*d-h+d+i);switch("smart"===r&&(r=o>=p-h&&o<=f+h?"auto":"center"),r){case"start":return f;case"end":return p;case"center":var g=Math.round(p+(f-p)/2);return g<Math.ceil(h/2)?0:g>m+Math.floor(h/2)?m:g;default:return o>=p&&o<=f?o:o<p?p:f}},getStartIndexForOffset:function(e,t){var r=e.itemCount,o=e.itemSize;return Math.max(0,Math.min(r-1,Math.floor(t/o)))},getStopIndexForStartIndex:function(e,t,r){var o=e.direction,n=e.height,i=e.itemCount,s=e.itemSize,a=e.layout,l=e.width,d=t*s,c="horizontal"===o||"horizontal"===a?l:n,u=Math.ceil((c+r-d)/s);return Math.max(0,Math.min(i-1,t+u-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});var R=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),w=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},j=function(){function e(){var t,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];return r=o=w(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(i))),o._lastRenderedStartIndex=-1,o._lastRenderedStopIndex=-1,o._memoizedUnloadedRanges=[],o._onItemsRendered=function(e){var t=e.visibleStartIndex,r=e.visibleStopIndex;o._lastRenderedStartIndex=t,o._lastRenderedStopIndex=r,o._ensureRowsLoaded(t,r)},o._setRef=function(e){o._listRef=e},w(o,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,n.PureComponent),R(e,[{key:"resetloadMoreItemsCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._memoizedUnloadedRanges=[],e&&this._ensureRowsLoaded(this._lastRenderedStartIndex,this._lastRenderedStopIndex)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return(0,this.props.children)({onItemsRendered:this._onItemsRendered,ref:this._setRef})}},{key:"_ensureRowsLoaded",value:function(e,t){var r=this.props,o=r.isItemLoaded,n=r.itemCount,i=r.minimumBatchSize,s=void 0===i?10:i,a=r.threshold,l=void 0===a?15:a,d=function(e){for(var t=e.isItemLoaded,r=e.itemCount,o=e.minimumBatchSize,n=e.startIndex,i=e.stopIndex,s=[],a=null,l=null,d=n;d<=i;d++)t(d)?null!==l&&(s.push(a,l),a=l=null):(l=d,null===a&&(a=d));if(null!==l){for(var c=Math.min(Math.max(l,a+o-1),r-1),u=l+1;u<=c&&!t(u);u++)l=u;s.push(a,l)}if(s.length)for(;s[1]-s[0]+1<o&&s[0]>0;){var h=s[0]-1;if(t(h))break;s[0]=h}return s}({isItemLoaded:o,itemCount:n,minimumBatchSize:s,startIndex:Math.max(0,e-l),stopIndex:Math.min(n-1,t+l)});(this._memoizedUnloadedRanges.length!==d.length||this._memoizedUnloadedRanges.some(function(e,t){return d[t]!==e}))&&(this._memoizedUnloadedRanges=d,this._loadUnloadedRanges(d))}},{key:"_loadUnloadedRanges",value:function(e){for(var t=this,r=this.props.loadMoreItems||this.props.loadMoreRows,o=function(o){var n=e[o],i=e[o+1],s=r(n,i);null!=s&&s.then(function(){if(function(e){var t=e.lastRenderedStartIndex,r=e.lastRenderedStopIndex,o=e.startIndex,n=e.stopIndex;return!(o>r||n<t)}({lastRenderedStartIndex:t._lastRenderedStartIndex,lastRenderedStopIndex:t._lastRenderedStopIndex,startIndex:n,stopIndex:i})){if(null==t._listRef)return;"function"==typeof t._listRef.resetAfterIndex?t._listRef.resetAfterIndex(n,!0):("function"==typeof t._listRef._getItemStyleCache&&t._listRef._getItemStyleCache(-1),t._listRef.forceUpdate())}})},n=0;n<e.length;n+=2)o(n)}}]),e}();const C=n.memo(({products:t,hasNextPage:r,isNextPageLoading:o,loadNextPage:i,itemHeight:s=400,overscan:a=5})=>{const l=n.useMemo(()=>{if("undefined"==typeof window)return 4;const e=window.innerWidth;return e<768?1:e<1024?2:e<1280?3:4},[]),d=Math.ceil(t.length/l),c=r?d+1:d,u=n.useMemo(()=>({products:t,itemsPerRow:l}),[t,l]);return e.jsx("div",{className:"virtualized-list-container",style:{height:"600px",width:"100%"},children:e.jsx(j,{isItemLoaded:e=>e<d,itemCount:c,loadMoreItems:i,children:({onItemsRendered:t,ref:r})=>e.jsx(_,{ref:r,height:600,itemCount:c,itemSize:s,itemData:u,onItemsRendered:t,overscanCount:a,className:"virtualized-list",children:P})})})}),P=n.memo(({index:t,style:r,data:o})=>{const{products:n,itemsPerRow:i}=o,s=t*i,a=Math.min(s+i,n.length),d=n.slice(s,a);return s>=n.length?e.jsx("div",{style:r,className:"loading-row",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:Array.from({length:i}).map((t,r)=>e.jsxs("div",{className:"skeleton-card",children:[e.jsx("div",{className:"skeleton",style:{height:"200px",marginBottom:"1rem"}}),e.jsx("div",{className:"skeleton",style:{height:"20px",marginBottom:"0.5rem"}}),e.jsx("div",{className:"skeleton",style:{height:"16px",width:"60%"}})]},r))})}):e.jsx("div",{style:r,className:"product-row",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 p-4",children:[d.map(t=>e.jsx(l,{product:t},t.id)),d.length<i&&Array.from({length:i-d.length}).map((t,r)=>e.jsx("div",{style:{visibility:"hidden"}},`placeholder-${r}`))]})})});P.displayName="VirtualizedRow",C.displayName="VirtualizedProductList";const z=n.memo(()=>{const[i,s]=n.useState({sortBy:"name",sortOrder:"asc"}),[l,d]=n.useState(""),c=t(l,500),u=n.useMemo(()=>({...i,search:c||void 0}),[i,c]),{data:h,isLoading:m,isError:f,error:p,fetchNextPage:g,hasNextPage:v,isFetchingNextPage:x}=a(["products",u],({pageParam:e=1})=>o.getProducts(u,e,20),{getNextPageParam:e=>e.hasNextPage?e.page+1:void 0,staleTime:12e4,cacheTime:3e5,keepPreviousData:!0}),y=n.useMemo(()=>h?.pages.flatMap(e=>e.data)??[],[h]),S=n.useCallback(e=>{s(t=>({...t,...e}))},[]),b=n.useCallback(e=>{d(e.target.value)},[]),I=n.useCallback(()=>{v&&!x&&g()},[v,x,g]);return f?e.jsxs("div",{className:"error-state",style:{padding:"4rem 0",textAlign:"center"},children:[e.jsx("h2",{children:"Error loading products"}),e.jsx("p",{children:p?.message||"Something went wrong"})]}):e.jsx("div",{className:"products-page",style:{padding:"2rem 0"},children:e.jsxs("div",{className:"container",children:[e.jsx("h1",{style:{fontSize:"2.5rem",fontWeight:"600",marginBottom:"2rem",color:"var(--color-text)"},children:"Products"}),e.jsxs("div",{className:"filters-section",style:{display:"flex",flexWrap:"wrap",gap:"1rem",marginBottom:"2rem",padding:"1.5rem",backgroundColor:"var(--color-bg)",borderRadius:"var(--border-radius)",boxShadow:"var(--box-shadow)"},children:[e.jsx("div",{style:{flex:"1",minWidth:"300px"},children:e.jsx("input",{type:"text",placeholder:"Search products...",value:l,onChange:b,style:{width:"100%",padding:"0.75rem 1rem",border:"2px solid var(--color-border)",borderRadius:"var(--border-radius)",fontSize:"1rem"}})}),e.jsxs("select",{value:i.sortBy,onChange:e=>S({sortBy:e.target.value}),style:{padding:"0.75rem 1rem",border:"2px solid var(--color-border)",borderRadius:"var(--border-radius)",fontSize:"1rem",backgroundColor:"var(--color-bg)"},children:[e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"price",children:"Sort by Price"}),e.jsx("option",{value:"rating",children:"Sort by Rating"}),e.jsx("option",{value:"createdAt",children:"Sort by Date"})]}),e.jsxs("select",{value:i.sortOrder,onChange:e=>S({sortOrder:e.target.value}),style:{padding:"0.75rem 1rem",border:"2px solid var(--color-border)",borderRadius:"var(--border-radius)",fontSize:"1rem",backgroundColor:"var(--color-bg)"},children:[e.jsx("option",{value:"asc",children:"Ascending"}),e.jsx("option",{value:"desc",children:"Descending"})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsx("input",{type:"number",placeholder:"Min Price",value:i.minPrice||"",onChange:e=>S({minPrice:e.target.value?Number(e.target.value):void 0}),style:{width:"120px",padding:"0.75rem 1rem",border:"2px solid var(--color-border)",borderRadius:"var(--border-radius)",fontSize:"1rem"}}),e.jsx("span",{children:"-"}),e.jsx("input",{type:"number",placeholder:"Max Price",value:i.maxPrice||"",onChange:e=>S({maxPrice:e.target.value?Number(e.target.value):void 0}),style:{width:"120px",padding:"0.75rem 1rem",border:"2px solid var(--color-border)",borderRadius:"var(--border-radius)",fontSize:"1rem"}})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",padding:"0.75rem 1rem",backgroundColor:"var(--color-bg-light)",borderRadius:"var(--border-radius)"},children:[e.jsx("input",{type:"checkbox",checked:i.inStock||!1,onChange:e=>S({inStock:!!e.target.checked||void 0})}),"In Stock Only"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("p",{style:{color:"var(--color-text-light)"},children:[h?.pages[0]?.total?`${h.pages[0].total} products found`:"",c&&` for "${c}"`]}),x&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(r,{size:"small",message:""}),e.jsx("span",{style:{color:"var(--color-text-light)",fontSize:"0.875rem"},children:"Loading more..."})]})]}),m?e.jsx(r,{message:"Loading products..."}):y.length>0?e.jsx(C,{products:y,hasNextPage:!!v,isNextPageLoading:x,loadNextPage:I,itemHeight:450,overscan:2}):e.jsxs("div",{className:"no-products",style:{textAlign:"center",padding:"4rem 2rem",color:"var(--color-text-light)"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"🔍"}),e.jsx("h3",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:"No products found"}),e.jsx("p",{children:"Try adjusting your search criteria or filters"})]})]})})});z.displayName="ProductsPage";export{z as default};
